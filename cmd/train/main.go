package main

import (
	"fmt"
	"github.com/Insulince/jnet"
	"log"
	"math/rand"
	"time"
)

func init() {
	rand.Seed(time.Now().Unix())
}

func main() {
	trainingData := jnet.TrainingData{
		// 0
		{
			Data: []float64{
				1, 1, 1, 0, 0,
				1, 0, 1, 0, 0,
				1, 0, 1, 0, 0,
				1, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
			},
			Truth: []float64{1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 1, 1, 1, 0,
				0, 1, 0, 1, 0,
				0, 1, 0, 1, 0,
				0, 1, 0, 1, 0,
				0, 1, 1, 1, 0,
			},
			Truth: []float64{1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 1, 1, 1,
				0, 0, 1, 0, 1,
				0, 0, 1, 0, 1,
				0, 0, 1, 0, 1,
				0, 0, 1, 1, 1,
			},
			Truth: []float64{1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		},
		// 1
		{
			Data: []float64{
				1, 0, 0, 0, 0,
				1, 0, 0, 0, 0,
				1, 0, 0, 0, 0,
				1, 0, 0, 0, 0,
				1, 0, 0, 0, 0,
			},
			Truth: []float64{0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 1, 0, 0, 0,
				0, 1, 0, 0, 0,
				0, 1, 0, 0, 0,
				0, 1, 0, 0, 0,
				0, 1, 0, 0, 0,
			},
			Truth: []float64{0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 1, 0, 0,
				0, 0, 1, 0, 0,
				0, 0, 1, 0, 0,
				0, 0, 1, 0, 0,
				0, 0, 1, 0, 0,
			},
			Truth: []float64{0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 0, 1, 0,
				0, 0, 0, 1, 0,
				0, 0, 0, 1, 0,
				0, 0, 0, 1, 0,
				0, 0, 0, 1, 0,
			},
			Truth: []float64{0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 0, 0, 1,
				0, 0, 0, 0, 1,
				0, 0, 0, 0, 1,
				0, 0, 0, 0, 1,
				0, 0, 0, 0, 1,
			},
			Truth: []float64{0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
		},
		// 2
		{
			Data: []float64{
				1, 1, 1, 0, 0,
				0, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
				1, 0, 0, 0, 0,
				1, 1, 1, 0, 0,
			},
			Truth: []float64{0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 1, 1, 1, 0,
				0, 0, 0, 1, 0,
				0, 1, 1, 1, 0,
				0, 1, 0, 0, 0,
				0, 1, 1, 1, 0,
			},
			Truth: []float64{0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 1, 1, 1,
				0, 0, 0, 0, 1,
				0, 0, 1, 1, 1,
				0, 0, 1, 0, 0,
				0, 0, 1, 1, 1,
			},
			Truth: []float64{0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
		},
		// 3
		{
			Data: []float64{
				1, 1, 1, 0, 0,
				0, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
				0, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
			},
			Truth: []float64{0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 1, 1, 1, 0,
				0, 0, 0, 1, 0,
				0, 1, 1, 1, 0,
				0, 0, 0, 1, 0,
				0, 1, 1, 1, 0,
			},
			Truth: []float64{0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 1, 1, 1,
				0, 0, 0, 0, 1,
				0, 0, 1, 1, 1,
				0, 0, 0, 0, 1,
				0, 0, 1, 1, 1,
			},
			Truth: []float64{0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
		},
		// 4
		{
			Data: []float64{
				1, 0, 1, 0, 0,
				1, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
				0, 0, 1, 0, 0,
				0, 0, 1, 0, 0,
			},
			Truth: []float64{0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 1, 0, 1, 0,
				0, 1, 0, 1, 0,
				0, 1, 1, 1, 0,
				0, 0, 0, 1, 0,
				0, 0, 0, 1, 0,
			},
			Truth: []float64{0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 1, 0, 1,
				0, 0, 1, 0, 1,
				0, 0, 1, 1, 1,
				0, 0, 0, 0, 1,
				0, 0, 0, 0, 1,
			},
			Truth: []float64{0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
		},
		// 5
		{
			Data: []float64{
				1, 1, 1, 0, 0,
				1, 0, 0, 0, 0,
				1, 1, 1, 0, 0,
				0, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 1, 1, 1, 0,
				0, 1, 0, 0, 0,
				0, 1, 1, 1, 0,
				0, 0, 0, 1, 0,
				0, 1, 1, 1, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 1, 1, 1,
				0, 0, 1, 0, 0,
				0, 0, 1, 1, 1,
				0, 0, 0, 0, 1,
				0, 0, 1, 1, 1,
			},
			Truth: []float64{0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
		},
		// 6
		{
			Data: []float64{
				1, 1, 1, 0, 0,
				1, 0, 0, 0, 0,
				1, 1, 1, 0, 0,
				1, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 1, 1, 1, 0,
				0, 1, 0, 0, 0,
				0, 1, 1, 1, 0,
				0, 1, 0, 1, 0,
				0, 1, 1, 1, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 1, 1, 1,
				0, 0, 1, 0, 0,
				0, 0, 1, 1, 1,
				0, 0, 1, 0, 1,
				0, 0, 1, 1, 1,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
		},
		// 7
		{
			Data: []float64{
				1, 1, 1, 0, 0,
				0, 0, 1, 0, 0,
				0, 0, 1, 0, 0,
				0, 0, 1, 0, 0,
				0, 0, 1, 0, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 0, 1, 0, 0},
		},
		{
			Data: []float64{
				0, 1, 1, 1, 0,
				0, 0, 0, 1, 0,
				0, 0, 0, 1, 0,
				0, 0, 0, 1, 0,
				0, 0, 0, 1, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 0, 1, 0, 0},
		},
		{
			Data: []float64{
				0, 0, 1, 1, 1,
				0, 0, 0, 0, 1,
				0, 0, 0, 0, 1,
				0, 0, 0, 0, 1,
				0, 0, 0, 0, 1,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 0, 1, 0, 0},
		},
		// 8
		{
			Data: []float64{
				1, 1, 1, 0, 0,
				1, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
				1, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
		},
		{
			Data: []float64{
				0, 1, 1, 1, 0,
				0, 1, 0, 1, 0,
				0, 1, 1, 1, 0,
				0, 1, 0, 1, 0,
				0, 1, 1, 1, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
		},
		{
			Data: []float64{
				0, 0, 1, 1, 1,
				0, 0, 1, 0, 1,
				0, 0, 1, 1, 1,
				0, 0, 1, 0, 1,
				0, 0, 1, 1, 1,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
		},
		// 9
		{
			Data: []float64{
				1, 1, 1, 0, 0,
				1, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
				0, 0, 1, 0, 0,
				1, 1, 1, 0, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		},
		{
			Data: []float64{
				0, 1, 1, 1, 0,
				0, 1, 0, 1, 0,
				0, 1, 1, 1, 0,
				0, 0, 0, 1, 0,
				0, 1, 1, 1, 0,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		},
		{
			Data: []float64{
				0, 0, 1, 1, 1,
				0, 0, 1, 0, 1,
				0, 0, 1, 1, 1,
				0, 0, 0, 0, 1,
				0, 0, 1, 1, 1,
			},
			Truth: []float64{0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		},
	}

	nm := []int{25, 16, 16, 10}
	labels := []string{"0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
	nw, err := jnet.NewNetwork(nm, labels)
	if err != nil {
		log.Fatalln(err)
	}

	trainConfig := jnet.TrainingConfiguration{
		LearningRate:       0.1,
		TrainingIterations: 2500000,
		MiniBatchSize:      32,
		AverageLossCutoff:  0.5,
	}
	err = nw.Train(trainingData, trainConfig)
	if err != nil {
		log.Fatalln(err)
	}

	input := []float64{
		1, 1, 1, 0, 0,
		1, 0, 1, 0, 0,
		1, 1, 1, 0, 0,
		0, 0, 1, 0, 0,
		1, 1, 1, 0, 0,
	}

	prediction, err := nw.Predict(input)
	if err != nil {
		log.Fatalln(err)
	}
	fmt.Println(prediction)
}
